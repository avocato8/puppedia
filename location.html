<!doctype html>
<html lang="ko">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>ì‚°ì±…ë¡œ</title>
    <script src="apikey.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.7.0.min.js" integrity="sha256-2Pmvv0kuTBOenSvLm6bvfBSSHrUJ+3A7x6P5Ebd07/g=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm" crossorigin="anonymous"></script>
    <link rel="stylesheet" type="text/css" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Gasoek+One&family=Jua&family=Noto+Sans+KR&display=swap" rel="stylesheet">
    
    
    <style>
      .secondbar{
        position: fixed;
        display: none;
        background-color: #80d4f6;
      }
      #map{
        margin : auto;
      }
      article{
        display: flex;
        margin: auto;
      }
      img{
        width: 470px;
        height: auto;
      }
    </style>
  </head>
  <body>
    <header>

      <div id="topmenu">
        <h1><a href="index.html" id="title">ğŸ•ëŒ•ëŒ•ë°±ê³¼</a></h1>

        <nav>
          <ul>
            <li><a class="hover1" href="dogimage.html" id="proud">ê°•ì•„ì§€ ìë‘í•´ìš”</a></li>
            <li id='locationMenu'><a class="hover1" href="location.html">ì‚°ì±…ë¡œ</a>
              <ul class="secondbar">
                <li><a class="province" id="seoul">ìˆ˜ë„ê¶Œ</a></li>
                <li><a class="province" id="gangwon">ê°•ì›ê¶Œ</a></li> 
                <li><a class="province" id="chungcheong">ì¶©ì²­ê¶Œ</a></li>
                <li><a class="province" id="jeolla">ì „ë¼ê¶Œ</a></li>
                <li><a class="province" id="gyeongsang">ê²½ìƒê¶Œ</a></li>
                <li><a class="province" id="jeju">ì œì£¼ê¶Œ</a></li>
              </ul>
            </li>
          </ul>
        </nav>
      </div>

      <script>
        $(document).ready(function(){
          $('#locationMenu').mouseenter(function(){
            console.log('mouseenter!!');
            var submenu = $(this).find('.secondbar');
            submenu.slideDown();
          }).mouseleave(function(){
            console.log('mouseout!!');
            var submenu = $(this).find('.secondbar');
            submenu.slideUp();
          });
        });

      </script>

      <div>
        <div class="input-group mb-3">
          <input type="text" class="form-control" placeholder="" aria-label="ê²€ìƒ‰" aria-describedby="button-addon2">
          <button class="btn btn-outline-secondary" type="button" id="button-addon2">ê²€ìƒ‰</button>
        </div>
      </div>
      

    </header>

    

    <section>

      <!-- Button trigger modal -->
      <button type="button" class="btn btn-primary" id="modal_button" data-bs-toggle="modal" data-bs-target="#exampleModal">
        Launch demo modal
      </button>

      <script>
        const modalButton = document.getElementById('modal_button');
        modalButton.hidden = true;
      </script>

      <!-- Modal -->
      <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
          <div class="modal-content">
            <div class="modal-header">
              <h1 class="modal-title fs-5" id="exampleModalLabel">Modal title</h1>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body" id="infomation">
              <div id="address_name"></div>
              <div id="phone"></div>
              <div id="dogPicture"><img ></div>
              
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            </div>
          </div>
        </div>
      </div>

      <article>
        <div id="map" style="width: 1300px; height: 780px;"></div>
      
        <script type="text/javascript" id = mapScript src = "//dapi.kakao.com/v2/maps/sdk.js?appkey=562b49500c914af20d7e270c61698744"></script>
        <script>
          let markers = [];
          var mapContainer = document.getElementById('map'), // ì§€ë„ë¥¼ í‘œì‹œí•  div 
              mapOption = { 
                center: new kakao.maps.LatLng(37.491539, 126.918663), // ì§€ë„ì˜ ì¤‘ì‹¬ì¢Œí‘œ
                level: 10 // ì§€ë„ì˜ í™•ëŒ€ ë ˆë²¨
              };
          
          //ì§€ë„ ìƒì„±
          var map = new kakao.maps.Map(mapContainer, mapOption);
          var markerPosition = new kakao.maps.LatLng(37.491539, 126.918663);

          function moveCenter(latitude, longitude){
            var moveLatLon = new kakao.maps.LatLng(latitude, longitude);
            map.setCenter(moveLatLon);

          }

          var provinces = document.querySelectorAll(".secondbar .province");

          for (var i = 0; i < provinces.length; i++){
            provinces[i].addEventListener('click', click);
          }

          function click(e){
            if(this.innerHTML === 'ìˆ˜ë„ê¶Œ'){
              moveCenter(37.491539, 126.918663);
              level: 10;
            }
            else if(this.innerHTML === 'ê°•ì›ê¶Œ'){
              moveCenter(37.885277, 127.729864);
              level: 10;
            }
            else if(this.innerHTML === 'ì¶©ì²­ê¶Œ'){
              moveCenter(36.347648, 127.384051);
              level: 10;
            }
            else if(this.innerHTML === 'ì „ë¼ê¶Œ'){
              moveCenter(35.160515, 126.850849);
              level: 10;
            }
            else if(this.innerHTML === 'ê²½ìƒê¶Œ'){
              moveCenter(36.019961, 129.343448);
              level: 10;
            }
            else if(this.innerHTML === 'ì œì£¼ê¶Œ'){
              moveCenter(33.488314, 126.498437);
              level: 10;
            }
          }

          //ë§ˆì»¤
          var positions = [
          {
            content: '<div>ë³´ë¼ë§¤ê³µì› ë°˜ë ¤ê²¬ ë†€ì´í„°</div>', 
            latlng: new kakao.maps.LatLng(37.491078, 126.919388)
          },
          {
            content: '<div>ì›”ë“œì»µê³µì› ë°˜ë ¤ê²¬ ë†€ì´í„°</div>', 
            latlng: new kakao.maps.LatLng(37.566327, 126.893205)
          },
          {
            content: '<div>í¬í•­ëŒ•ëŒ•ë™ì‚°</div>', 
            latlng: new kakao.maps.LatLng(35.948892, 129.384235)
          },
          {
            content: '<div>êµ¬ë¡œêµ¬ ë°˜ë ¤ê²¬ ë†€ì´í„°</div>', 
            latlng: new kakao.maps.LatLng(37.507119, 126.874455)
          },
          {
            content: '<div>ë§¤í—Œì‹œë¯¼ì˜ ìˆ²</div>', 
            latlng: new kakao.maps.LatLng(37.470913, 127.035793)
          },
          {
            content: '<div>ì´ˆì•ˆì‚°ê·¼ë¦°ê³µì› ë°˜ë ¤ê²¬ ë†€ì´í„°</div>', 
            latlng: new kakao.maps.LatLng(37.642681, 127.042668)
          },
          {
            content: '<div>ì†¡íŒŒêµ¬ ë°˜ë ¤ê²¬ ë†€ì´í„°</div>', 
            latlng: new kakao.maps.LatLng(37.496379, 127.099963)
          },
          {
            content: '<div>ë¶ì„œìš¸ê¿ˆì˜ ìˆ² ë°˜ë ¤ê²¬ ë†€ì´í„°</div>', 
            latlng: new kakao.maps.LatLng(37.623572, 127.041456)
          },
          {
            content: '<div>ì–´ë¦°ì´ëŒ€ê³µì› ë°˜ë ¤ê²¬ ë†€ì´í„°</div>', 
            latlng: new kakao.maps.LatLng(37.545649, 127.084164)
          },
          {
            content: '<div>íƒ„ì²œ ë°˜ë ¤ê²¬ ë†€ì´í„°</div>', 
            latlng: new kakao.maps.LatLng(37.437242, 127.119626)
          },
          {
            content: '<div>êµ¬ê°ˆ ë ˆìŠ¤í”¼ì•„ ë°˜ë ¤ê²¬ ë†€ì´í„°</div>', 
            latlng: new kakao.maps.LatLng(37.266652, 127.132141)
          },
          {
            content: '<div>ë§¤ì†¡íœ´ê²Œì†Œ ë°˜ë ¤ê²¬ ë†€ì´í„°</div>', 
            latlng: new kakao.maps.LatLng(37.265314, 126.888884)
          },
          {
            content: '<div>ê°€í‰íœ´ê²Œì†Œ ì• ê²¬íŒŒí¬</div>', 
            latlng: new kakao.maps.LatLng(37.796311, 127.478943)
          },
          {
            content: '<div>ê¸°í¥ë ˆìŠ¤í”¼ì•„í˜¸ìˆ˜ê³µì› ë°˜ë ¤ê²¬ ë†€ì´í„°</div>', 
            latlng: new kakao.maps.LatLng(37.253737, 127.095203)
          },
          {
            content: '<div>ê´‘ëª…ì‹œ ë°˜ë ¤ê²¬ ë†€ì´í„°</div>', 
            latlng: new kakao.maps.LatLng(37.443965, 126.897566)
          },
          {
            content: '<div>ì„±ê³¡ ë°˜ë ¤ê²¬ ë†€ì´í„°</div>', 
            latlng: new kakao.maps.LatLng(37.323211, 126.736802)
          },
          {
            content: '<div>ê´‘êµí˜¸ìˆ˜ê³µì› ë°˜ë ¤ê²¬ë†€ì´í„°</div>', 
            latlng: new kakao.maps.LatLng(37.285380, 127.078744)
          },
          {
            content: '<div>ê°€í‰íœ´ê²Œì†Œ ì• ê²¬íŒŒí¬</div>', 
            latlng: new kakao.maps.LatLng(37.796311, 127.478943)
          },
          {
            content: '<div>ì†ì´ˆ ë°˜ë ¤ê²¬ ë†€ì´í„°</div>', 
            latlng: new kakao.maps.LatLng(38.214532, 128.569378)
          },
          {
            content: '<div>í–‰ë‹´ë„íœ´ê²Œì†Œ ì• ê²¬íŒŒí¬</div>', 
            latlng: new kakao.maps.LatLng(36.944983, 126.807623)
          },
          {
            content: '<div>ì„œì‚°íœ´ê²Œì†Œ ì• ê²¬ ë†€ì´í„°</div>', 
            latlng: new kakao.maps.LatLng(36.734164, 126.566518)
          },
          {
            content: '<div>ì„œì‚°íœ´ê²Œì†Œ ì• ê²¬ ë†€ì´í„°</div>', 
            latlng: new kakao.maps.LatLng(36.734164, 126.566518)
          },
          {
            content: '<div>ê´‘ì£¼ ìš´ë‚¨ë™ê·¼ë¦°ê³µì› ë°˜ë ¤ê²¬ ë†€ì´í„°</div>', 
            latlng: new kakao.maps.LatLng(35.171018, 126.816126)
          },
          {
            content: '<div>ë¶€ì‚° ìš¸ë¦¼ê³µì› ë°˜ë ¤ê²¬ ë†€ì´í„°</div>', 
            latlng: new kakao.maps.LatLng(35.101416, 128.926804)
          },
          ];

          for (var i = 0; i < positions.length; i++) {
              // ë§ˆì»¤ë¥¼ ìƒì„±
            var marker = new kakao.maps.Marker({
                map: map, // ë§ˆì»¤ë¥¼ í‘œì‹œí•  ì§€ë„
                position: positions[i].latlng, // ë§ˆì»¤ì˜ ìœ„ì¹˜
            });

            markers.push(marker);

                // ë§ˆì»¤ì— í‘œì‹œí•  ì¸í¬ìœˆë„ìš°ë¥¼ ìƒì„±
              var infowindow = new kakao.maps.InfoWindow({
                content: positions[i].content
              });

              // í´ë¡œì €ë¥¼ ì‚¬ìš©í•˜ì—¬ í´ë¦­ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ì •ì˜
            (function (infowindow) {
              kakao.maps.event.addListener(marker, 'click', function () {
                var content = infowindow.getContent();
                content = content.replace(/<.*?>/g, '');
                console.log(content);

                $.ajax({
                  method: "GET",
                  url: "https://dapi.kakao.com/v2/local/search/keyword?query=" + content,
                  headers: { Authorization: config.kakaoApi }
                })
                .done(function (data) {
                  console.log(data);
                  $('#address_name').replaceWith('<div id="address_name">' + data.documents[0].address_name + '</div>');
                  $('#phone').replaceWith('<div id="phone">' + data.documents[0].phone + '</div>');
                })
                $(document).ready(function(){
                  $('#exampleModalLabel').replaceWith('<h1 class="modal-title fs-5" id="exampleModalLabel">' + content + '</h1>')
                  $.ajax({
                  method: "GET",
                  url: "https://dapi.kakao.com/v2/search/image?query=" + content,
                  headers: { Authorization: config.kakaoApi }
                })
                .done(function (image) {
                  console.log(image);
                  $('#dogPicture').html("<div id='dogPicture'><img referrerpolicy='no-referrer' src=" + image.documents[0].image_url + "></div>");
                  $('#modal_button').click();
                });
                })
              });

            })(infowindow);

            // ë§ˆì»¤ì— mouseover, mouseout ì´ë²¤íŠ¸ë¥¼ ë“±ë¡
            kakao.maps.event.addListener(marker, 'mouseover', makeOverListener(map, marker, infowindow));
            kakao.maps.event.addListener(marker, 'mouseout', makeOutListener(infowindow));
          }  

            // ì¸í¬ìœˆë„ìš°ë¥¼ í‘œì‹œí•˜ëŠ” í´ë¡œì €ë¥¼ ë§Œë“œëŠ” í•¨ìˆ˜ 
            function makeOverListener(map, marker, infowindow) {
                return function() {
                    infowindow.open(map, marker);
                };
            }

            // ì¸í¬ìœˆë„ìš°ë¥¼ ë‹«ëŠ” í´ë¡œì €ë¥¼ ë§Œë“œëŠ” í•¨ìˆ˜
            function makeOutListener(infowindow) {
              return function() {
                infowindow.close();
              };
            }

        </script>
       </article>
    </section>

    </body>
</html>